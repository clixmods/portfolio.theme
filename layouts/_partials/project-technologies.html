{{/* Partial to display project technologies */}}
{{/* Combine programming_languages, frameworks_engines, specialties and tools */}}
{{ $allTech := slice }}

{{/* Add programming languages */}}
{{ with .Params.programming_languages }}
    {{ $allTech = $allTech | append . }}
{{ end }}

{{/* Add frameworks and engines */}}
{{ with .Params.frameworks_engines }}
    {{ $allTech = $allTech | append . }}
{{ end }}

{{/* Add specialties */}}
{{ with .Params.specialties }}
    {{ $allTech = $allTech | append . }}
{{ end }}

{{/* Add tools */}}
{{ with .Params.tools }}
    {{ $allTech = $allTech | append . }}
{{ end }}

{{/* Deduplicate */}}
{{ $allTech = $allTech | uniq }}
{{ $techCount := len $allTech }}

<div class="ps5-tile-tech">
    {{ range first 3 $allTech }}
        {{ $techName := . }}
        {{ $found := false }}
        
        {{/* Search in programming_languages */}}
        {{ range $.Site.Data.programming_languages }}
            {{ if eq .name $techName }}<span class="ps5-tile-tech-item">{{ partial "tech-icon.html" . }} {{ .name }}</span>{{ $found = true }}{{ end }}
        {{ end }}
        
        {{/* Search in frameworks_engines if not found */}}
        {{ if not $found }}
            {{ range $.Site.Data.frameworks_engines }}
                {{ if eq .name $techName }}<span class="ps5-tile-tech-item">{{ partial "tech-icon.html" . }} {{ .name }}</span>{{ $found = true }}{{ end }}
            {{ end }}
        {{ end }}
        
        {{/* Search in specialties if not found */}}
        {{ if not $found }}
            {{ range $.Site.Data.specialties }}
                {{ if eq .name $techName }}<span class="ps5-tile-tech-item">{{ partial "tech-icon.html" . }} {{ .name }}</span>{{ $found = true }}{{ end }}
            {{ end }}
        {{ end }}
        
        {{/* Search in tools if not found */}}
        {{ if not $found }}
            {{ range $.Site.Data.tools }}
                {{ if eq .name $techName }}<span class="ps5-tile-tech-item">{{ partial "tech-icon.html" . }} {{ .name }}</span>{{ $found = true }}{{ end }}
            {{ end }}
        {{ end }}
        
        {{ if not $found }}<span class="ps5-tile-tech-item">{{ $techName }}</span>{{ end }}
    {{ end }}
    {{ if gt $techCount 3 }}<span class="ps5-tile-tech-more">+{{ sub $techCount 3 }}</span>{{ end }}
</div>
