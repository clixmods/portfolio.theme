{{/* 
  Helper to render a clickable skill block with modal integration
  Usage: {{ partial "helpers/skill-block.html" (dict "skill" . "skillType" "programming-language" "skillCategory" "programming-languages" "context" $) }}
  
  Parameters:
  - skill: The skill data object from site data (required)
  - skillType: Type for data attribute (required) - e.g., "programming-language", "framework-engine", "specialty", "soft-skill"
  - skillCategory: Category for data attribute (optional) - e.g., "programming-languages", "frameworks"
  - context: Hugo context for accessing site data (required)
  - additionalClasses: Additional CSS classes (optional)
  - showExperience: Whether to show experience text (optional, default: true)
  - useRelURL: Whether to use relURL for icon paths (optional, default: false)
*/}}

{{- $skill := .skill -}}
{{- $skillType := .skillType -}}
{{- $skillCategory := .skillCategory -}}
{{- $context := .context -}}
{{- $additionalClasses := .additionalClasses | default "" -}}
{{- $showExperience := .showExperience | default true -}}
{{- $useRelURL := .useRelURL | default false -}}

{{- if not $skill -}}
  {{- errorf "skill-block helper: 'skill' parameter is required" -}}
{{- end -}}

{{- if not $skillType -}}
  {{- errorf "skill-block helper: 'skillType' parameter is required" -}}
{{- end -}}

{{- if not $context -}}
  {{- errorf "skill-block helper: 'context' parameter is required" -}}
{{- end -}}

{{- /* Format experience text if needed */ -}}
{{- $experienceText := "" -}}
{{- if and $showExperience $skill.experience -}}
  {{- $experienceText = partial "helpers/format-experience.html" $skill.experience -}}
{{- end -}}

{{- /* Determine icon path */ -}}
{{- $iconPath := "" -}}
{{- if $skill.iconPath -}}
  {{- if $useRelURL -}}
    {{- $iconPath = $skill.iconPath | relURL -}}
  {{- else -}}
    {{- $iconPath = $skill.iconPath -}}
  {{- end -}}
{{- else -}}
  {{- $iconPath = $skill.icon -}}
{{- end -}}

{{- /* Build onclick parameters */ -}}
{{- $iconType := "emoji" -}}
{{- if $skill.iconPath -}}
  {{- $iconType = "svg" -}}
{{- end -}}

{{- /* Build description parameter */ -}}
{{- $description := $skill.description | default "" -}}

<div class="skill-block clickable{{ with $additionalClasses }} {{ . }}{{ end }}" 
     onclick="openSkillModal('{{ $skill.name }}', '{{ $iconPath }}', '{{ $description }}', '{{ $skill.experience }}', '{{ $iconType }}')"
     data-skill-name="{{ $skill.name }}"
     data-skill-type="{{ $skillType }}"{{ if $skillCategory }}
     data-skill-category="{{ $skillCategory }}"{{ end }}>
    <span class="skill-icon">
        {{ if $skill.iconPath }}
          <img src="{{ $iconPath }}" alt="{{ $skill.name }}" class="tech-icon-svg" width="28" height="28">
        {{ else }}
          <span class="tech-icon-emoji">{{ $skill.icon }}</span>
        {{ end }}
    </span>
    <span class="skill-name">{{ $skill.name }}</span>
    {{- if and $showExperience $experienceText -}}
    <span class="skill-level">{{ $experienceText }}</span>
    {{- else if $skill.subtitle -}}
    <span class="skill-level">{{ $skill.subtitle }}</span>
    {{- end -}}
</div>
