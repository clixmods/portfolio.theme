{{/*
  Partial: Specialties Modal Layout
  Description: HTML structure for displaying specialties in project widget modals
  Context: 
    - .specialties (slice) - List of specialties used in the project
    - .projectId (string) - Project ID for contextualizing actions
    - .profileData (dict) - Profile data for the developer section
*/}}

{{- $specialties := .specialties -}}
{{- $projectId := .projectId | default "" -}}
{{- $profileData := .profileData -}}

{{- if $specialties -}}
  {{- $total := len $specialties -}}
  {{- $totalExperience := 0 -}}
  {{- $categories := dict -}}
  
  {{/* Calculate total experience and group by type/category if necessary */}}
  {{- range $specialties -}}
    {{- $experience := .experience | default 0 -}}
    {{- $totalExperience = add $totalExperience $experience -}}
    {{/* Specialties don't have categories, but we could group them by expertise domain */}}
  {{- end -}}
  
  {{- $avgExperience := 0 -}}
  {{- if gt $total 0 -}}
    {{- $avgExperience = div $totalExperience $total -}}
  {{- end -}}

  <div class="specialties-modal">
    {{/* Statistics bar */}}
    <div class="specialties-stats-bar">
      <div class="widget-count">
        <strong>{{ $total }}</strong> sp√©cialit√©{{ if gt $total 1 }}s{{ end }}
      </div>
    </div>
    
    {{/* Developer note */}}
    {{- if $profileData -}}
    <div class="developer-profile-note">
      <div class="profile-avatar">
        <img src="{{ $profileData.media.profileImage }}" alt="{{ $profileData.personal.fullName }}" loading="lazy">
      </div>
      <div class="profile-note-content">
        <div class="profile-note-title">Sp√©cialit√©s de {{ $profileData.personal.firstName }} pour ce projet</div>
        <div class="profile-note-subtitle">{{ $profileData.personal.title }}</div>
      </div>
    </div>
    {{- end -}}
    
    {{/* Specialties grid */}}
    <div class="specialties-grid">
      {{- range $specialties -}}
        {{- $specialtyName := .name | default "Sp√©cialit√©" -}}
        {{- $specialtyIcon := .icon | default "üß©" -}}
        {{- $specialtySubtitle := .subtitle | default "" -}}
        {{- $specialtyExperience := .experience | default 0 -}}
        
        <div class="specialty-card" 
             data-specialty="{{ $specialtyName }}" 
             tabindex="0" 
             role="button" 
             aria-label="Voir les d√©tails de {{ $specialtyName }}"
             onclick="openSkillModal('{{ $specialtyName }}', '{{ $specialtyIcon }}', 'Sp√©cialit√©', '{{ $specialtyExperience }} an{{ if gt $specialtyExperience 1 }}s{{ end }}', 'emoji')"
             style="cursor: pointer;">
          
          {{/* Specialty header */}}
          <div class="specialty-header">
            <div class="specialty-icon widget-icon widget-icon--lg" aria-hidden="true">{{ $specialtyIcon }}</div>
            <div class="specialty-info">
              <div class="specialty-title">{{ $specialtyName }}</div>
              {{- if $specialtySubtitle -}}
                <div class="specialty-subtitle">{{ $specialtySubtitle }}</div>
              {{- end -}}
            </div>
          </div>
          
          {{/* Simple badge with years of experience */}}
          <div class="specialty-badge widget-badge">
            {{ $specialtyExperience }} an{{ if gt $specialtyExperience 1 }}s{{ end }}
          </div>
        </div>
      {{- end -}}
    </div>
    
    {{/* Interaction note */}}
    <div class="specialties-interaction-note">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
        <path d="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z"/>
      </svg>
      Cliquez sur une sp√©cialit√© pour voir les projets associ√©s et plus de d√©tails
    </div>
  </div>
{{- else -}}
  <div class="specialties-modal">
    <div class="specialties-stats-bar">
      <div class="specialties-count">
        <strong>0</strong> sp√©cialit√©s
      </div>
    </div>
    <div class="specialties-empty">
      <div class="empty-icon" aria-hidden="true">üß©</div>
      <div class="empty-message">
        <h4>Aucune sp√©cialit√© sp√©cifi√©e</h4>
        <p>Ce projet n'a pas de sp√©cialit√©s d√©finies dans ses m√©tadonn√©es.</p>
      </div>
    </div>
  </div>
{{- end -}}
