{{/*
  Partial: Specialties Modal Layout
  Description: Structure HTML pour l'affichage des sp√©cialit√©s dans les modals de project widget
  Context: 
    - .specialties (slice) - Liste des sp√©cialit√©s utilis√©es dans le projet
    - .projectId (string) - ID du projet pour contextualiser les actions
    - .profileData (dict) - Donn√©es du profil pour la section d√©veloppeur
*/}}

{{- $specialties := .specialties -}}
{{- $projectId := .projectId | default "" -}}
{{- $profileData := .profileData -}}

{{- if $specialties -}}
  {{- $total := len $specialties -}}
  {{- $totalExperience := 0 -}}
  {{- $categories := dict -}}
  
  {{/* Calculer l'exp√©rience totale et grouper par type/cat√©gorie si n√©cessaire */}}
  {{- range $specialties -}}
    {{- $experience := .experience | default 0 -}}
    {{- $totalExperience = add $totalExperience $experience -}}
    {{/* Les sp√©cialit√©s n'ont pas de cat√©gories, mais on pourrait les grouper par domaine d'expertise */}}
  {{- end -}}
  
  {{- $avgExperience := 0 -}}
  {{- if gt $total 0 -}}
    {{- $avgExperience = div $totalExperience $total -}}
  {{- end -}}

  <div class="specialties-modal">
    {{/* Barre de statistiques */}}
    <div class="specialties-stats-bar">
      <div class="widget-count">
        <strong>{{ $total }}</strong> {{ i18n "domains_applied" | default "domaines appliqu√©s" }}
      </div>
    </div>
    
    {{/* Note d√©veloppeur */}}
    {{- if $profileData -}}
    <div class="developer-profile-note">
      <div class="profile-avatar">
        <img src="{{ $profileData.media.profileImage }}" alt="{{ $profileData.personal.fullName }}" loading="lazy">
      </div>
      <div class="profile-note-content">
        <div class="profile-note-title">{{ i18n "specialties_of_for_project" | default "Sp√©cialit√©s de {0} pour ce projet" | replaceRE "\\{0\\}" $profileData.personal.firstName }}</div>
        <div class="profile-note-subtitle">{{ $profileData.personal.title }}</div>
      </div>
    </div>
    {{- end -}}
    
    {{/* Grille des sp√©cialit√©s */}}
    <div class="specialties-grid">
      {{- range $specialties -}}
        {{- $specialtyName := .name | default "Sp√©cialit√©" -}}
        {{- $specialtyIcon := .icon | default "üß©" -}}
        {{- $specialtySubtitle := .subtitle | default "" -}}
        {{- $specialtyExperience := .experience | default 0 -}}
        
        <div class="specialty-card" 
             data-specialty="{{ $specialtyName }}" 
             tabindex="0" 
             role="button" 
             aria-label="Voir les d√©tails de {{ $specialtyName }}"
             onclick="openSkillModal('{{ $specialtyName }}', '{{ $specialtyIcon }}', 'Sp√©cialit√©', '{{ $specialtyExperience }} an{{ if gt $specialtyExperience 1 }}s{{ end }}', 'emoji')"
             style="cursor: pointer;">
          
          {{/* En-t√™te de sp√©cialit√© */}}
          <div class="specialty-header">
            <div class="specialty-icon widget-icon widget-icon--lg" aria-hidden="true">{{ $specialtyIcon }}</div>
            <div class="specialty-info">
              <div class="specialty-title">{{ $specialtyName }}</div>
              {{- if $specialtySubtitle -}}
                <div class="specialty-subtitle">{{ $specialtySubtitle }}</div>
              {{- end -}}
            </div>
          </div>
          
          {{/* Badge simple avec ann√©es d'exp√©rience */}}
          <div class="specialty-badge widget-badge">
            {{ $specialtyExperience }} an{{ if gt $specialtyExperience 1 }}s{{ end }}
          </div>
        </div>
      {{- end -}}
    </div>
    
    {{/* Note d'interaction */}}
    <div class="specialties-interaction-note">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
        <path d="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z"/>
      </svg>
      {{ i18n "click_specialty_see_projects" | default "Cliquez sur une sp√©cialit√© pour voir les projets associ√©s et plus de d√©tails" }}
    </div>
  </div>
{{- else -}}
  <div class="specialties-modal">
    <div class="specialties-stats-bar">
      <div class="specialties-count">
        <strong>0</strong> sp√©cialit√©s
      </div>
    </div>
    <div class="specialties-empty">
      <div class="empty-icon" aria-hidden="true">üß©</div>
      <div class="empty-message">
        <h4>Aucune sp√©cialit√© sp√©cifi√©e</h4>
        <p>Ce projet n'a pas de sp√©cialit√©s d√©finies dans ses m√©tadonn√©es.</p>
      </div>
    </div>
  </div>
{{- end -}}
