{{/*
  Partial: Development Time Modal Enhanced Layout
  Description: Structure HTML pour l'affichage détaillé du temps de développement dans les modals de project widget
  Context: 
    - .development_time (dict) - Données du temps de développement avec total, dates, phases
    - .projectId (string) - ID du projet pour contextualiser les actions
*/}}

{{- $devTime := .development_time -}}
{{- $projectId := .projectId | default "" -}}

{{- if $devTime -}}
  {{- $phases := $devTime.phases -}}
  {{- $hasPhases := and $phases (gt (len $phases) 0) -}}
  {{- $hasDateRange := and $devTime.start_date $devTime.end_date -}}

  <div class="development-time-modal-enhanced">
    
    {{/* Header avec statistiques principales */}}
    <div class="devtime-stats-overview">
      <div class="devtime-main-stat">
        <div class="devtime-main-value">{{ $devTime.total }}</div>
        <div class="devtime-main-label">{{ i18n "total_time" | default "Temps total" }}</div>
      </div>
      
      {{- if $hasDateRange -}}
        <div class="devtime-date-range">
          <div class="devtime-date-item">
            <div class="devtime-date-icon">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/>
                <path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/>
                <path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/>
                <path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/>
              </svg>
            </div>
            <div class="devtime-date-content">
              <div class="devtime-date-value">{{ $devTime.start_date }}</div>
              <div class="devtime-date-label">{{ i18n "project_start" | default "Début du projet" }}</div>
            </div>
          </div>
          <div class="devtime-date-separator">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M5 12h14"/>
              <path d="m12 5 7 7-7 7"/>
            </svg>
          </div>
          <div class="devtime-date-item">
            <div class="devtime-date-icon">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/>
                <path d="M4 22v-7"/>
              </svg>
            </div>
            <div class="devtime-date-content">
              <div class="devtime-date-value">{{ $devTime.end_date }}</div>
              <div class="devtime-date-label">{{ i18n "project_end" | default "Fin du projet" }}</div>
            </div>
          </div>
        </div>
      {{- end -}}
    </div>

    {{/* Timeline des phases si disponibles */}}
    {{- if $hasPhases -}}
      <div class="devtime-phases-section">
        <div class="devtime-phases-header">
          <h4>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
              <polyline points="14,2 14,8 20,8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
              <polyline points="10,9 9,9 8,9"/>
            </svg>
            Phases de développement
          </h4>
          <div class="devtime-phases-count">{{ len $phases }} phase{{ if gt (len $phases) 1 }}s{{ end }}</div>
        </div>
        
        <div class="devtime-timeline">
          {{- range $index, $phase := $phases -}}
            {{- $isLast := eq $index (sub (len $phases) 1) -}}
            <div class="devtime-timeline-item {{ if eq $index 0 }}first{{ end }} {{ if $isLast }}last{{ end }}" 
                 data-phase-index="{{ $index }}">
              
              {{/* Bullet point avec numéro */}}
              <div class="devtime-timeline-bullet">
                <span class="devtime-phase-number">{{ add $index 1 }}</span>
              </div>
              

              
              {{/* Contenu de la phase */}}
              <div class="devtime-phase-content">
                <div class="devtime-phase-header">
                  <h5 class="devtime-phase-name">{{ .name }}</h5>
                  <div class="devtime-phase-duration">{{ .duration }}</div>
                </div>
                
                {{/* Barre de progression visuelle (optionnelle) */}}
                <div class="devtime-phase-progress">
                  <div class="devtime-phase-progress-bar" 
                       data-progress="{{ div (mul (add $index 1) 100) (len $phases) }}"></div>
                </div>
              </div>
            </div>
          {{- end -}}
        </div>
      </div>
    {{- end -}}

    {{/* Méthodologie uniquement */}}
    <div class="devtime-summary-section">
      <div class="devtime-summary-grid">
        <div class="devtime-summary-card">
          <div class="devtime-card-icon">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"/>
              <path d="m13 12-3 5h4l-3 5"/>
            </svg>
          </div>
          <div class="devtime-card-content">
            <h5>Méthodologie</h5>
            <p>{{ if $hasPhases }}Développement par phases{{ else }}Développement continu{{ end }}</p>
          </div>
        </div>
      </div>
    </div>

  </div>
  
{{- else -}}
  <div class="devtime-no-data">
    <div class="devtime-no-data-icon">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"/>
        <polyline points="12,6 12,12 16,14"/>
      </svg>
    </div>
    <div class="devtime-no-data-text">
      <h4>Aucune donnée de développement</h4>
      <p>Les informations sur le temps de développement ne sont pas disponibles pour ce projet.</p>
    </div>
  </div>
{{- end -}}