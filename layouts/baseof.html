<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}" dir="{{ cond (eq .Site.Language.LanguageDirection `rtl`) `rtl` `ltr` }}" data-theme="dark" data-page="{{ if .IsHome }}portfolio{{ else if eq .Section "posts" }}blog{{ else if eq .Section "projects" }}projects{{ else }}portfolio{{ end }}">
<head>
  {{ partial "head.html" . }}
</head>
<body>
  <!-- Script d'initialisation du thème avant le rendu pour éviter le flash -->
  <!-- FORCE DARK MODE ONLY - Light mode not implemented yet -->
  <script>
    (function() {
      try {
        // Force dark mode always, ignore localStorage and browser preferences
        document.documentElement.setAttribute('data-theme', 'dark');
        localStorage.setItem('theme', 'dark');
      } catch(e) {}
    })();
  </script>
  <!-- Hero Background - Deep Space Aesthetic -->
  <!-- Désactiver les waves si le projet a une image background pour optimiser les ressources -->
  {{ if not (and (eq .Section "projects") .Params.image) }}
    {{ partial "hero-background.html" . }}
  {{ end }}
  
  <!-- Mobile Menu - Menu hamburger pour mobile -->
  {{ partial "mobile-menu.html" . }}
  
  <!-- Profile Badge - Badge de profil avec actions intégrées -->
  {{ partial "profile-badge.html" . }}
  
  <!-- Right Dock - Trophées et langue -->
  {{ partial "right-dock.html" . }}
  <!-- Modal des compétences -->
  {{ partial "skill-modal.html" . }}
  
  <!-- Auto Person Modal -->
  {{ partial "auto-person-modal.html" . }}
  
  <main>
    {{ block "main" . }}{{ end }}
  </main>
  <footer>
    {{ partial "footer.html" . }}
  </footer>
  
  <!-- Dock de navigation -->
  {{ partial "dock.html" . }}
  
  <!-- Global portfolio data for skill modal and other components - MUST be loaded first -->
  {{ partial "portfolio-data.html" . }}

  <!-- Scripts pour le menu mobile -->
  {{ $mobileMenuJs := resources.Get "js/navigation/mobile-menu.js" }}
  {{ if $mobileMenuJs }}
    <script>{{ $mobileMenuJs.Content | safeJS }}</script>
  {{ end }}
  
  <!-- Scripts pour la modal des compétences -->
  {{ $skillModalJs := resources.Get "js/modals/skill/skill-modal.js" }}
  {{ if $skillModalJs }}
    <script>{{ $skillModalJs.Content | safeJS }}</script>
  {{ end }}
  
  <!-- Scripts pour la modal des personnes -->
  {{ $personModalLogic := resources.Get "js/modals/person/person-modal-logic.js" }}
  {{ if $personModalLogic }}
    <script>{{ $personModalLogic.Content | safeJS }}</script>
  {{ end }}

  <!-- Unified Modal System (replaces legacy Discord modal and others) -->
  {{ $unifiedModalJs := resources.Get "js/modals/unified-modal-system.js" }}
  {{ if $unifiedModalJs }}
    <script>{{ $unifiedModalJs.Content | safeJS }}</script>
  {{ end }}

  <!-- Number Formatter Utility -->
  {{ $numberFormatterJs := resources.Get "js/utils/number-formatter.js" }}
  {{ if $numberFormatterJs }}
    <script>{{ $numberFormatterJs.Content | safeJS }}</script>
  {{ end }}

  <!-- Widgets Formatter (pour ranking, downloads, etc.) -->
  {{ $widgetsFormatterJs := resources.Get "js/utils/widgets-formatter.js" }}
  {{ if $widgetsFormatterJs }}
    <script>{{ $widgetsFormatterJs.Content | safeJS }}</script>
  {{ end }}
  
</body>
</html>
