<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}" dir="{{ cond (eq .Site.Language.LanguageDirection `rtl`) `rtl` `ltr` }}" data-theme="dark" data-page="{{ if .IsHome }}portfolio{{ else if eq .Section "posts" }}blog{{ else if eq .Section "projects" }}projects{{ else }}portfolio{{ end }}">
<head>
  {{ partial "head.html" . }}
</head>
<body>
  <!-- Script d'initialisation du thème avant le rendu pour éviter le flash -->
  <script>
    (function() {
      try {
        var saved = localStorage.getItem('theme');
        if(!saved){
          var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          saved = prefersDark ? 'dark' : 'light';
        }
        document.documentElement.setAttribute('data-theme', saved);
      } catch(e) {}
    })();
  </script>
  <!-- Hero Background - Deep Space Aesthetic -->
  {{ partial "hero-background.html" . }}
  
  <!-- Top Dock - Actions principales -->
  {{ partial "top-dock.html" . }}
  
  <!-- Right Dock - Trophées et langue -->
  {{ partial "right-dock.html" . }}
  
  <!-- Modal de contact globale -->
  {{ partial "contact-modal.html" . }}
  
  <!-- Modal des compétences -->
  {{ partial "skill-modal.html" . }}
  
  <!-- Auto Person Modal -->
  {{ partial "auto-person-modal.html" . }}
  
  <main>
    {{ block "main" . }}{{ end }}
  </main>
  <footer>
    {{ partial "footer.html" . }}
  </footer>
  
  <!-- Dock de navigation -->
  {{ partial "dock.html" . }}
  
  <!-- Scripts pour la modal des compétences -->
  {{ $skillModalJs := resources.Get "js/skill-modal.js" }}
  {{ if $skillModalJs }}
    <script>{{ $skillModalJs.Content | safeJS }}</script>
  {{ end }}
  
  <!-- Scripts pour la modal des personnes -->
  {{ $personModalLogic := resources.Get "js/person-modal-logic.js" }}
  {{ if $personModalLogic }}
    <script>{{ $personModalLogic.Content | safeJS }}</script>
  {{ end }}
  
  <!-- Scripts pour le système de trophées -->
  {{ $trophiesJs := resources.Get "js/trophies.js" }}
  {{ if $trophiesJs }}
    <script>{{ $trophiesJs.Content | safeJS }}</script>
  {{ end }}
</body>
</html>
